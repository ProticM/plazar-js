!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.pz=e()}(this,function(){"use strict";var m,c,u,a,h,e,i,r,s,n,p,o,l,t;return c=m||(m={}),u={moduleTypes:{class:"class",component:"component",mixin:"mixin"},types:{array:"[object Array]",object:"[object Object]",fn:"[object Function]",string:"[object String]",nodeList:"[object NodeList]"},typeNotFound:"Type [{0}] was not found within definitions",typeMustBeStringOrObject:"First parameter can be string or object",canNotCreate:"Can not create an instance based on provided arguments",canNotDefine:"Can not define type based on provided arguments",coreBaseTypes:["base","mixin"],defaultNamespace:"pz"},a=function(t,e,i){var n,s=function(t){if(c.isEmpty(t))throw new TypeError(u.canNotConvertNullOrEmptyObj);for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(!c.isEmpty(n))for(var r in n)c.isObject(n[r])?e[r]=s({},n[r]):c.isArray(n[r])?e[r]=n[r].slice():Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r=!!c.isEmpty(i)||i?s({},t):t;return n=s(r,e),s=null,n},h=function(t,e){var i=!p(e)&&e;return r(t)?i?new t:t():t},e=function(t,e){return Object.prototype.toString.call(t)===e},i="isArray"in Array?Array.isArray:function(t){return e(t,u.types.array)},r=function(t){return e(t,u.types.fn)},s=function(t){return e(t,u.types.string)},n=function(t){return e(t,u.types.nodeList)},p=function(t,e){return!e&&(null==t||t=={})||!e&&""===t||(i(t)||n(t))&&!e&&0===t.length},o=function(t,e){return!p(t)&&!p(t.ownerType)&&t.ownerType==e},l=function(t,e,i,n){var r,s,o=!p(i)&&i,a=function(t){return o&&(t.id==e||t.type==e)||t.type==e||!c.isEmpty(t.alias)&&t.alias==e};return r=o?t.application.instances:t.definitions,s=n?r.filter(a):t.find(a,r),r=a=null,s},c.ns=function(t,e){!function(t,e){for(var i=t.split("."),n=window,r="",s=0,o=i.length;s<o;s++)n[r=i[s]]=n[r]||{},n=n[r]}(t)},c.defineStatic=function(t,e,i){var n=h(e),r=p(i)?"statics":i,s=r==u.defaultNamespace;p(window[r])&&!s&&c.ns(r);var o,a,l=s?this:1==(a=(o=r).split(".")).length?window[o]:a.reduce(function(t,e){return c.isString(t)?window[t][e]:t[e]});p(t)?c.assignTo(l,n,!1):l[t]=n},c.getDefinitionOf=function(t){var e=l(this,t);if(p(e)){var i=c.str.format(u.typeNotFound,t);throw new Error(i)}return e.definition},c.getInstanceOf=function(t,e){return l(this,t,!0,e)},c.defineApplication=function(t){var e,i,n=!c.isEmpty(t.components)&&c.isArray(t.components)?t.components:[];delete t.components,delete t.instances,a(c.application,t),p(window[t.namespace])&&this.ns(t.namespace,t),c.assignTo(window[t.namespace],t,!1),c.forEach(n,function(t){var e=c.getDefinitionOf(t);r(e.create)&&e.create()}),e="init",!p(i=t)&&r(i[e])&&i[e].call(i)},c.find=function(t,e,i){var n="find"in Array.prototype?e.find(t,i):function(t,e,i){for(var n=0,r=t.length;n<r;n++)if(e.call(i||t,t[n],n))return t[n];return null}(e,t,i);return t=null,n},c.definitions=[],c.application={instances:[]},c.define=function(t,e){var i,n,r,s,o,a,l=this;if(c.isEmpty(t)||c.isEmpty(e))throw new Error(u.canNotDefine);return n=c.toObject(e),i=(o=c.isEmpty(n.ownerType)||-1!=u.coreBaseTypes.indexOf(t))?c.toFunction(n):(r=c.getDefinitionOf(n.ownerType),(s=c.isMixin(n))?c.assignTo(n,c.assignTo({},r.prototype),!1):r.extend(n)),o&&(i.extend=e.extend),s||(i.create=(a=t,function(){return l.create(a)})),this.definitions.push({type:t,definition:i}),i},c.create=function(t){var e,i,n,r,s,o;if(c.isEmpty(t))throw new Error(u.canNotCreate);return i=(e=c.isObject(t))?t.type:t,n=c.getDefinitionOf(i),e?(delete(s=a({},t,!1)).type,r=new n(s),c.assignTo(r,t,!1)):(r=new n).type=i,r.id=c.guid(),o=r,!c.isEmpty(o.require)&&c.isArray(o.require)&&c.forEach(o.require,function(t){var e=c.getInstanceOf(t),i=c.isEmpty(e)?c.getDefinitionOf(t):e,n=c.str.camelize(t);!c.isEmpty(i)&&c.isEmpty(o[n])&&(o[n]=c.isFunction(i)?c.create(t):i)}),(c.isComponent(r)||c.isClass(r))&&(r.applyMixins(),r.autoLoad&&r.load()),c.application.instances.push(r),r},c.toObject=h,c.toFunction=function(t){var e=function(){this.constructor=t.constructor};return r(e.prototype=t)?t:e},c.isTypeOf=e,c.isArray=i,c.isObject=function(t){return e(t,u.types.object)},c.isFunction=r,c.isString=s,c.isNodeList=n,c.isEmpty=p,c.is=o,c.isComponent=function(t){return o(t,u.moduleTypes.component)||1==t.isComponentInstance},c.isMixin=function(t){return o(t,u.moduleTypes.mixin)},c.isClass=function(t){return o(t,u.moduleTypes.class)},c.forEach=function(t,e,i){for(var n=p(t)?0:t.length,r=0;r<n;r++){var s=e.call(i||t[r],t[r],r,t);if(0==s)return s}e=null},c.proxy=function(e,i){var t,n;if(s(i)&&(t=e[i],i=e,e=t),r(e))return n=Array.prototype.slice.call(arguments,2),function(){var t=c.isComponent(i)&&i.destroyed?c.getInstanceOf(i.type):i;return e.apply(t||this,n.concat(Array.prototype.slice.call(arguments)))}},c.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},c.toJSON=function(t,e,i){var n,r=i||!1;try{n=r?JSON.stringify(t):JSON.parse(t)}catch(t){if(!e)throw new Error(t)}return n},c.assignTo=a,c.isInstanceOf=function(t,e){return t instanceof e},m.defineStatic("http",function(){var c="Can not instantiate http request without options defined",u="Minimal configuration for ajax call was not provided. Please check you setup for following options [url], [method]",h={done:4},p={abort:0},e="POST",i="GET",d={json:"json",html:"html"};return{requests:{},latestRequestId:null,request:function(t){if(m.isEmpty(t))throw new Error(c);!function(t){if(m.isEmpty(t.url)||m.isEmpty(t.method))throw new Error(u)}(t);var e,i,n,r,s,o,a,l={id:m.guid(),aborted:!1,options:t,xhr:new XMLHttpRequest,abort:function(){this.xhr.abort(),this.xhr=null,this.aborted=!0}};return this.latestRequestId=l.id,n=(e=l).xhr,r=(i=t).success,s=i.fail,o=i.abort,a=i.dataType||d.json,n.onreadystatechange=function(){if((this.readyState!=h.done||this.status!=p.abort)&&this.readyState==h.done&&!m.isEmpty(r)){var t={request:this,data:a==d.json?m.toJSON(this.responseText):this.responseText,dataType:a};r.call(this,t),delete m.http.requests[e.id]}},n.onerror=function(t){if(delete m.http.requests[e.id],!s)throw new Error(t.target.statusText);s(t.target)},n.onabort=function(t){o&&o(t)},n.open(i.method,i.url,!0),m.isString(i.data)&&(i.data=m.toJSON(i.data)),n.send(i.data||null),this.requests[l.id]=l},abort:function(t){var e,i=t||!1,n=i?this.requests:this.requests[this.latestRequestId];if(!m.isEmpty(n)){if(!i)return n.abort(),delete this.requests[this.latestRequestId],void(this.latestRequestId=null);e=m.obj.getKeys(n),m.forEach(e,function(t){var e=this.requests[t];e.abort(),delete this.requests[t],e=null},this),n=null,this.latestRequestId=null}},post:function(t){return t.method=e,this.request(t)},get:function(t){return t.method=i,this.request(t)}}},"pz"),m.defineStatic("binder",function(){var a,l,d,r,c,s,i,o,h,p,t,f;return p={idx:"$index",current:"$current",root:"$root",as:" as ",observed:"$observed",view:"$view"},f=function(){return m.isEmpty(t)&&(t=RegExp("^"+m.binder.prefix+"-","i")),t},o=function(t,e){var i=t.split(".");return 1==i.length?e:(i.pop(),i.reduce(function(t,e){return m.isString(t)?window[t][e]:m.isEmpty(t)?null:t[e]},e))},h=function(t,e,i){var n=null!=i,r=/^[a-z$][a-z0-9]*(?:\.[a-z0-9]+)+$/i.test(t),s=r&&-1!=t.indexOf(p.root);return t=s?t.split(".").slice(1).join("."):t,(!n||r||s?o(t,e):i)||o(t,i)},c=function(n){if(!m.isObject(n)||n.$observed)return!1;var t=Object.keys(n);return m.forEach(t,function(t){var e=n[t],i=s(n,e,t);i&&!m.isInstanceOf(n,l)&&(n[t]=i),i||m.isInstanceOf(n,a)||c(e)||m.isFunction(e)||(n[t]=new a(n,t))}),n.$observed=!0},s=function(t,e,i){var n;return m.isArray(e)&&(n=new l(t,e,i),m.forEach(n,function(t){c(t)})),n},a=function(){function t(t,e){var n,i,r,s;return this.value=t[e],this.prop=e,this.subscriptions=[],n=this,s=(i=t)[r=e],delete i[r],Object.defineProperty(i,r,{configurable:!0,enumerable:!0,set:function(t){var e=null!=t.value||null!=t.value?t.value:t,i=e!=s&&null!=n.notify;s=e,i&&n.notify()},get:function(){var t=function(){return s};return t.subscribe=function(t,e){n.subscribe.call(n,t,e)},t.unsubscribe=function(t){n.unsubscribe.call(n,t)},t}}),this}return t.prototype.notify=function(){0!=this.subscriptions.length&&m.forEach(this.subscriptions,function(t){t.update.call(this,t)},this)},t.prototype.subscribe=function(t,e){var i=this.subscriptions.length;this.subscriptions.push({id:e||i++,update:t})},t.prototype.unsubscribe=function(e){var t=this.subscriptions.filter(function(t){return t.id==e});m.forEach(t,function(t){var e=this.subscriptions.indexOf(t);this.subscriptions.splice(e,1)},this)},t}(),l=function(){var o="pop push shift unshift splice reverse sort".split(" "),t="slice concat join some every forEach map filter reduce reduceRight indexOf lastIndexOf toString toLocaleString".split(" "),s=Array.prototype;function e(t,e,i){e=e||[],this.subscriptions=[],this.prop=i;for(var n=0;n<e.length;n++)this.push(e[n]);var r=this.length;return this.hasData=0<r,Object.defineProperty(this,"length",{configurable:!1,enumerable:!0,set:function(t){var e;r<t&&(e="push"==this.__action?this[r]:this[0],c(e)),t!=r&&(r=t,this.hasData=0<r)},get:function(){return r}}),this.hasData=new a(this,"hasData"),this}return e.prototype=[],m.forEach(o,function(n){var r=s[n];e.prototype[n]=function(){this.__action=n;var t=r.apply(this,arguments),e=this.subscriptions.filter(function(t){return t.name==n})[0];if(e){var i=s.slice.call(arguments);e.callback.apply(this,i)}return delete this.__action,t}}),m.forEach(t,function(t){e.prototype[t]=s[t]}),e.prototype.subscribe=function(e,i){this.subscriptions.splice(0,this.subscriptions.length),m.forEach(o,function(t){!function(t,e,i,n,r){if(!o[i])throw new Error("Can not "+(e?"subscribe to":"unsubscribe from")+" action named: ["+i+"]");var s=t.subscriptions.length;t.subscriptions.push({id:r||s++,name:i,callback:n})}(this,!0,t,e,i)},this),e=null},e.prototype.unsubscribe=function(e){var t=this.subscriptions.filter(function(t){return t.id==e});m.forEach(t,function(t){var e=this.subscriptions.indexOf(t);this.subscriptions.splice(e,1)},this)},e.prototype.getFirst=function(){return this.getAt(0)},e.prototype.getLast=function(){return this.getAt(this.length-1)},e.prototype.getAt=function(t){return m.isEmpty(t)?null:this[t]},e.prototype.removeAll=function(){this.splice(0,this.length)},e}(),i={parse:function(t){var l,n,e,c,u,r,s;3==t.nodeType&&0!=t.textContent.length&&(-1!=t.textContent.indexOf(m.binder.delimiters[0])&&-1!=t.textContent.indexOf(m.binder.delimiters[1])&&(l=[],u=(c=this).ctx||this.vm,n=function(t,a){t.el.textContent=t.tpl.replace(/{([^}]*)}/g,function(t,e){var i,n,r,s;r=-1!=(e=e.replace(/ +?/g,"")).indexOf(p.current),s=-1!=e.indexOf(p.idx),n=r?u:s?c.index:u[e],/^[a-z$][a-z0-9]*(?:\.[a-z0-9]+)+$/i.test(e)&&(i=e.split(".").pop(),n=c.ctx&&c.ctx[i]||c.vm[i]||h(e,c.vm,c.ctx)[i],i=null),a||l.push(e);var o=m.isEmpty(n)?t:m.isFunction(n)?n():n;return n=null,o})},this.elsData||(this.elsData=[]),e={el:t,tpl:t.textContent.trim()},this.elsData.push(e),n(e,!1),s=(r=this).elsData,m.forEach(l,function(t){var e=h(t,r.vm,r.ctx),i=e[t.split(".").pop()];i&&i.subscribe(function(){m.forEach(s,function(t){n(t,!0)})}),e=null}),l.splice(0,l.length),this.elsData.splice(0,l.length)))}},d=function(){function t(t,e,i,n,r){var s,o,a,l,c=(a=-1!=(s=i).indexOf(p.as),l={keypath:s,alias:null},a&&(o=s.split(p.as),l.keypath=o.shift().trim(),l.alias=o.pop().trim(),o=null),l);return this.id=m.guid(),this.el=t,this.view=r,this.type=e,this.keypath=c.keypath.trim(),this.alias=c.alias||null,this.bindingAttr=n,this.prop=c.keypath.split(".").pop(),this.rootVm=r.vm,this.vm=h(c.keypath,r.vm,r.ctx),this.binder=m.binder.binders[this.type],this.handler=this.binder.handler?m.proxy(this.binder.handler,this):void 0,r=null,this}return t.prototype.bind=function(){var t,e=this.vm[this.prop];this.binder.bind&&this.binder.bind.call(this),this.binder.react&&e&&e.subscribe&&(t=this,e.subscribe(function(){t.binder.react.call(t)},t.id)),this.binder.react&&this.binder.react.call(this)},t.prototype.unbind=function(){var t=this.vm[this.prop];t&&t.unsubscribe&&t.unsubscribe(this.id),m.isFunction(this.binder.unbind)&&this.binder.unbind.call(this)},t.prototype.getValue=function(){var t;return this.prop==p.current?this.vm:this.prop==p.idx?this.view.index:(t=this.vm[this.prop],m.isFunction(t)?this.vm[this.prop].call(this):this.vm[this.prop])},t.prototype.setValue=function(t){return this.vm[this.prop]=t},t}(),r=function(){function t(t,e,i,n){return this.els=m.isArray(t)||m.isNodeList(t)?t:[t],this.vm=e,this.ctx=i||null,this.index=m.isEmpty(n)?null:n,this.buildBindings(),e=null,this}return t.prototype.bind=function(){m.forEach(this.bindings,function(t){t.bind()})},t.prototype.unbind=function(){m.forEach(this.bindings,function(t){t.unbind()})},t.prototype.buildBindings=function(){this.bindings=[];var p,e=(p=this,function(t){m.forEach(t,function(u){var h=u.hasAttribute&&u.hasAttribute(m.binder.prefix+"-each"),t=h?[u.getAttributeNode(m.binder.prefix+"-each")]:u.attributes||[];m.forEach(t,function(t){if(f().test(t.name)){var e=(s=t.name,-1!=(o=s.indexOf("["))&&-1!=(a=s.indexOf("]"))?(l=s.substring(o+1,a),(c=(s=s.replace("-["+l+"]","")).split("-")).push(l),c):s.split("-")),i=e[1],n=e[2];if(!m.isEmpty(m.binder.binders[i])){var r=new d(u,i.toLowerCase(),t.value,t.name,p);n&&(r.attrToBind=n),p.bindings.push(r),h=h||r.binder.block,r=null}}var s,o,a,l,c}),h||m.forEach(u.childNodes,function(t){e([t]),i.parse.call(p,t)})})});e(this.els),this.bindings.sort(function(t,e){return t.binder.priority-e.binder.priority})},t}(),{prefix:"data",delimiters:["{","}"],bind:function(t,e){if(e.$view)e.$view.bind();else{c(e);var i=new r(t,e);i.bind(),e.$view=i,i=null}},unbind:function(t){t.$view&&t.$view.unbind()},toJSON:function(t){var a=function(s,o){var t,e=(t=s,Object.keys(t).filter(function(t){return t!=p.observed&&t!=p.view}));return m.forEach(e,function(n){var t=m.isObject(s[n]),e=m.isFunction(s[n]),i=m.isInstanceOf(s[n],l);if(t&&a(s[n],o),i){o[n]=[];var r=Object.keys(s[n]).filter(function(t){return!isNaN(parseInt(t))});m.forEach(r,function(t){var e=s[n][t],i=m.isObject(e)?a(e,{}):m.isFunction(e)?e():e;o[n].push(i)})}e&&(o[n]=s[n]())}),o};return a(t,{})},binders:{value:{priority:3,bind:function(){var t,e,i="INPUT"==this.el.nodeName,n="OPTION"==this.el.nodeName,r="SELECT"==this.el.nodeName,s="TEXTAREA"==this.el.nodeName;if(!(i||n||r||s))throw new Error("Value binding is supported only on INPUT, OPTION or SELECT element");t=i||s?"oninput"in window?"input":"keyup":"change",e=i&&"text"==this.el.type||s,(r||e)&&m.isFunction(this.handler)&&(this.el.removeEventListener(t,this.handler,!1),this.el.addEventListener(t,this.handler,!1),this.event=t),this.el.removeAttribute(this.bindingAttr)},react:function(){var t="INPUT"==this.el.nodeName,e="SELECT"==this.el.nodeName,i="TEXTAREA"==this.el.nodeName;t&&"text"==this.el.type||e||i?this.el.value=this.getValue():this.el.setAttribute("value",this.getValue())},handler:function(){this.setValue(this.el.value)},unbind:function(){this.el.removeEventListener(this.event,this.handler,!1)}},each:{priority:1,block:!0,bind:function(){this.mark||(this.mark=document.createComment("each:"+this.id),this.el.removeAttribute(this.bindingAttr),this.el.parentNode.insertBefore(this.mark,this.el),this.el.parentNode.removeChild(this.el)),this.views||(this.views=[])},react:function(){var n,t=this.getValue();m.forEach(this.views,function(t){t.unbind(),m.forEach(t.els,function(t){t.parentNode.removeChild(t),t=null}),t.els.splice(0,t.els.length)}),this.views.splice(0,this.views.length),m.forEach(t,function(t,e){this.alias&&(this.rootVm[this.alias]=t),n=this.el.cloneNode(!0);var i=new r(n,this.rootVm,t,e);i.bind(),this.mark.parentNode.insertBefore(n,this.mark),this.views.push(i)},this),delete this.rootVm[this.alias]},unbind:function(){m.forEach(this.views,function(t){t.unbind()})}},text:{priority:3,bind:function(){this.el.removeAttribute(this.bindingAttr)},react:function(){var t=this.el.hasOwnProperty("innerText");this.el[t?"innerText":"innerHTML"]=this.getValue()}},if:{priority:2,bind:function(t){var e=null!=t?t:this.getValue();this.el.removeAttribute(this.bindingAttr),e||m.isEmpty(this.el.parentNode)||this.el.parentNode.removeChild(this.el)}},ifnot:{priority:2,bind:function(){var t=this.getValue();m.binder.binders.if.bind.call(this,!t)}},visible:{priority:2,bind:function(){this.el.removeAttribute(this.bindingAttr)},react:function(t){var e=null!=t?t:this.getValue();null==this.initialValue&&(this.initialValue=this.el.style.display),this.el.style.display=1==e?"none"==this.initialValue?"":this.initialValue:"none"}},hidden:{bind:function(){m.binder.binders.visible.bind.call(this)},react:function(){var t=this.getValue();m.binder.binders.visible.react.call(this,!t)}},html:{bind:function(){this.el.removeAttribute(this.bindingAttr)},react:function(){this.el.innerHTML=this.getValue()}},attr:{priority:2,bind:function(){this.el.removeAttribute(this.bindingAttr)},react:function(){var t="class"==this.attrToBind,e=this.getValue();t&&this.el.hasAttribute(this.attrToBind)&&(e=(this.el.getAttribute(this.attrToBind)+" "+e).trim()),this.el.setAttribute(this.attrToBind,e.toString())}},checked:{bind:function(){this.el.removeEventListener("change",this.handler,!1),this.el.addEventListener("change",this.handler,!1),this.event="change",this.el.removeAttribute(this.bindingAttr)},react:function(){var t="radio"==this.el.type,e=this.getValue();this.el.checked=t?e==this.el.value:e},handler:function(){var t="radio"==this.el.type;this.setValue(t?this.el.value:this.el.checked)},unbind:function(){this.el.removeEventListener(this.event,this.handler,!1)}},enabled:{bind:function(){this.el.removeAttribute(this.bindingAttr)},react:function(){var t=this.getValue();this.el.disabled=!t}},options:{priority:1,block:!0,tempAttrs:{val:null,text:null},bind:function(){this.el.removeAttribute(this.bindingAttr),this.views||(this.views=[]),this.binder.tempAttrs.val=this.binder.tempAttrs.val||this.el.getAttribute("data-optionsvalue"),this.binder.tempAttrs.text=this.binder.tempAttrs.text||this.el.getAttribute("data-optionstext"),this.el.removeAttribute("data-optionsvalue"),this.el.removeAttribute("data-optionstext")},react:function(){var t=this.getValue();m.forEach(this.views,function(t){t.unbind(),m.forEach(t.els,function(t){t.parentNode.removeChild(t),t=null}),t.els.splice(0,t.els.length)}),this.views.splice(0,this.views.length),m.forEach(t,function(t,e){var i=document.createElement("option");i.setAttribute("data-value",this.binder.tempAttrs.val),i.setAttribute("data-text",this.binder.tempAttrs.text);var n=new r(i,this.rootVm,t,e);n.bind(),this.el.appendChild(i),this.views.push(n),i=null},this)}},unbind:function(){m.forEach(this.views,function(t){t.unbind()})}}}},"pz"),m.defineStatic("arr",function(){return{clear:function(t){m.isEmpty(t)||t.splice(0,t.length)},find:function(t,e,i){return m.find(t,e,i)},contains:function(t,e,i){var n;return m.isFunction(e)?(n=m.arr.find(e,t),!m.isEmpty(n)):!m.isEmpty(t)&&-1!=t.indexOf(e,i)},filter:function(t,e){var i=e.filter(t);return t=null,i},merge:function(){var t=Array.prototype.slice.call(arguments),e=[];return m.forEach(t,function(t){e=e.concat(t)}),e},map:function(t,e,i){var n=e.map(t,i);return t=null,n},removeAt:function(t,e){m.isEmpty(t)||m.isEmpty(e)||t.splice(e,1)}}},"pz"),m.defineStatic("str",function(){return{camelize:function(t){return m.isEmpty(t)?"":t.replace(/^([A-Z])|[\s-_](\w)/g,function(t,e,i,n){return i?i.toUpperCase():e.toLowerCase()})},capitalize:function(t){return m.isEmpty(t)?"":t.charAt(0).toUpperCase()+t.substr(1)||""},contains:function(t,e){return!m.isEmpty(t)&&!m.isEmpty(e)&&-1!=t.indexOf(e)},format:function(){var t=Array.prototype.slice.call(arguments),i=t[0],e=t.splice(1),n="";return m.isEmpty(i)||m.isEmpty(e)||m.forEach(e,function(t,e){n=m.isEmpty(n)?i.replace("{"+e+"}",t):n.replace("{"+e+"}",t)}),n}}},"pz"),m.defineStatic("dom",function(){var u=/<([^\s>]+)(\s|>)+/,h={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]};h.optgroup=h.option,h.tbody=h.tfoot=h.colgroup=h.caption=h.thead,h.th=h.td;var i=function(t,e,i){m.isEmpty(t)||m.isEmpty(e)||t.insertAdjacentHTML(i,m.isString(e)?e:e.outerHTML)},p={data:[],fn:function(e){for(var t,i,n,r,s,o=null,a=!1,l=0,c=!0,u=p.data.filter(function(t){return t.type==e.type});!m.isEmpty(n=u[l])&&!(a=m.dom.elementMatches(e.target,n.selector));)l++;if(r=a?n.selector:void 0,s=a?n.fn:void 0,n=null,(i=a)&&(o=e.target),!i){var h=m.dom.findParent(e.target,r);(c=m.isEmpty(h))||(o=h)}(t=i||!c)&&m.isEmpty(o)&&(o=this),t&&s.call(this,o,e)}};return{clone:function(t){return t.cloneNode(!0)},replaceWith:function(t,e){m.isEmpty(t)||m.isEmpty(e)||(t.parentNode.replaceChild(e,t),t=null)},append:function(t,e){m.isEmpty(t)||m.isEmpty(e)||(m.isString(e)&&(e=this.parseTemplate(e)),t.appendChild(e))},prepend:function(t,e){i(t,e,"afterbegin")},insertBefore:function(t,e){i(t,e,"beforebegin")},insertAfter:function(t,e){i(t,e,"afterend")},findElement:function(t,e,i){return m.isEmpty(e)?null:this.getEl(e,{rootEl:t,all:i||!1})},elementMatches:function(t,e){return(Element.prototype.matches||Element.prototype.msMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),i=e.length;0<=--i&&e.item(i)!==this;);return-1<i}).call(t,e)},findParent:function(t,e,i){for(var n=null;!m.isEmpty(t);){if(this.elementMatches(t,e)){n=t;break}if(i&&this.elementMatches(t,i))break;t=t.parentElement}return n},on:function(t,e,i,n){var r,s,o,a,l;m.isEmpty(n)||(r=m.isEmpty(e)?document:e,o=this,a=r,l=t,s=m.find(function(t){return t.el==a&&(!!m.isEmpty(l)||t.event==l)},o.listeners),p.data.push({selector:i,fn:n,type:t}),m.isEmpty(s)&&(r.addEventListener(t,p.fn),this.listeners.push({el:r,event:t})))},getByAttr:function(t,e){var i="*[".concat(e||"data-template").concat('="').concat(t).concat('"]');return document.querySelector(i)},getEl:function(t,e){var i=e&&e.all||!1,n=(e&&e.rootEl||document)[i?"querySelectorAll":"querySelector"](t);return m.isEmpty(n)?null:1==n.length&&"FORM"!=n.nodeName?n[0]:n},parseTemplate:function(t){var e,i,n,r,s,o,a,l,c;if(!m.isString(t))return null;if(n=t.trim(),s=u.exec(n),m.isEmpty(s))return null;for(l=document.createDocumentFragment(),e=s[1],o=h[e],a=m.isEmpty(o),(i=l.appendChild(this.createElement("div"))).innerHTML=a?n:o[1].concat(n).concat(o[2]),r=a?0:o[0];r--;)i=i.lastChild;return c=1==i.childNodes.length?i.lastChild:i.childNodes,i=l=null,c},createElement:function(t){var e;try{e=document.createElement(t)}catch(t){throw t}return e},remove:function(t){var e;m.isEmpty(t)||(e=t.parentNode,m.isEmpty(e)||e.removeChild(t),t=null)},insertAt:function(t,e,i){var n;if(!m.isEmpty(t)&&!m.isEmpty(i))if(m.isEmpty(t.childNodes))this.prepend(t,e);else{if(n=t.childNodes[i],m.isEmpty(n))throw new Error("Node at index: "+i+" was not found.");t.insertBefore(e,n)}},off:function(n,r){var s,t=m.find(function(t,e){var i=t.el==n&&(!!m.isEmpty(r)||t.event==r);return i&&(s=e),i},this.listeners);m.isEmpty(t)||t.el.removeEventListener(t.event,p.fn),this.listeners.splice(s,1)},listeners:[],indexOf:function(t){for(var e=0;null!=(t=t.previousSibling);)e++;return e}}},"pz"),m.defineStatic("obj",function(){return{assignTo:function(t,e,i){return m.assignTo(t,e,i)},clone:function(t){return this.assignTo({},t)},getKeys:Object.keys,getValues:function(t){var e,i=[];if("values"in Object)return Object.values(t);for(e in t)t.hasOwnProperty(e)&&i.push(t[e]);return i}}},"pz"),(t=function(){return{mixins:[],init:function(){},destroy:function(){var t=m.application.instances.indexOf(this);-1!=t&&m.application.instances.splice(t,1)},applyMixins:function(){var n=this;m.forEach(this.mixins,function(t){var e=m.getDefinitionOf(t),i=m.obj.clone(e);delete i.ownerType,m.obj.assignTo(n,i,!1)})}}}).extend=function t(e){var i,o,r,s,a,n=m.toObject(e),l=this,c=(i=l,r=(o=n)&&o.constructor&&o.constructor!=={}.constructor,s=m.obj.getKeys(o).reduce(function(t,e){return t[m.isFunction(o[e])?"fnKeys":"attrKeys"].push(e),t},{fnKeys:[],attrKeys:[]}),((a=function(){var t,n=this;return m.forEach(s.attrKeys,function(t){if(!n.hasOwnProperty(t)&&!m.isEmpty(o[t],!0)){var e=m.isArray(o[t]),i=m.isObject(o[t]);n[t]=e?o[t].slice():i?m.obj.clone(o[t]):o[t]}}),this.base=r?i:null,t=r?o.constructor.apply(this,arguments):i.apply(this,arguments),this.base=null,t||n}).prototype=Object.create(i.prototype)).constructor=a,m.forEach(s.fnKeys,function(t){var n,r,s;a.prototype[t]="constructor"==t?a.prototype.constructor:(r=o[n=t],s=i.prototype,function(){var t=this.base,e=!m.isEmpty(s[n])&&m.isFunction(s[n]);this.base=e?s[n]:function(){throw new Error("Method named: ["+n+"] was not found on type: ["+this.ownerType+"]")};var i=r.apply(this,arguments);return this.base=t,i})}),a.extend=t,a);return l=n=null,c},m.define("base",t),t=null,m.define("class",function(){return{ownerType:"base"}}),m.define("component",function(){var d={tplSourceNotDefined:"Template source not defined. Please define one of these options in your component config: 1. [template]; 2. [templateSelector]; 3. [ajaxSetup.url]",tplContainerNotDefined:"Template container selector not defined. Please define one of these options in your component config: 1. [renderTo]; 2. [templateSelector]; 3. [renderBefore]; 4. [renderAfter];",tplContainerNotFound:"Template container not found. Please review one of these options in your component config: 1. [renderTo]; 2. [templateSelector]; 3. [renderBefore]; 4. [renderAfter];",tplContainerNotFoundWithinComponent:"Template container not found within parent retrieved via selector: [{0}]. Please review one of these options in your component config: 1. [renderTo]; 2. [templateSelector]; 3. [renderBefore]; 4. [renderAfter];",loadingMaskMarkup:'<div class="loading-mask" style="color:#fff;background-color: #fff;position:absolute;top:0;left:0;bottom:0;width:100%;text-align:center;vertical-align:middle;height:100%">'.concat('<p style="position: absolute;top:40%;left:41.5%;background-color: #fff;padding: 5px;border: 1px solid #f1f1f1;color: #c0c0c0;z-index:1">loading...</p></div>'),addChildParamErr:"Component you're trying to add, or it's [type] property has not been provided via parameter for [addChild] function. Example invocation: parent.addChild({ type: 'myType' })",renderBeforeAndAfterDefined:"[renderBefore] and [renderAfter] config can not be defined on the same component",handlerFnNotProvided:"Handler function was not provided.",canNotDestroyComponent:"You can not destroy a component with attached pre-rendered template."};return{constructor:function(){this.isComponentInstance=!0},ownerType:"base",replace:!1,initialized:!1,animate:!1,showLoading:!1,autoLoad:!1,css:[],attrs:[],style:"",bindViewModel:function(){var t;if(!m.isEmpty(this.viewModel)&&m.isFunction(this.applyBindings)){if(t=m.isEmpty(this.templateSelector),this.applyBindings(),!t){var e=m.dom.getEl(this.templateSelector);m.dom.replaceWith(e,this.html),e=null}this.publish("bindings-complete",null,this)}},applyBindings:function(){m.binder.bind(this.html,this.viewModel)},unapplyBindings:function(){m.binder.unbind(this.viewModel)},traceUp:function(){return m.isEmpty(this.parentComponent)?null:m.isEmpty(this.parentComponent.$ref)?m.getInstanceOf(this.parentComponent.id):this.parentComponent.$ref},traceDown:function(e){if(m.isEmpty(this.components))return null;var t=this.components.filter(function(t){return t.type==e||t.id==e||t.alias==e}).map(function(t){return m.getInstanceOf(t.id)});return 1==t.length?t[0]:t},load:function(){var t,e=m.isEmpty(this.templateSelector),i=m.isEmpty(this.template),n=m.isEmpty(this.ajaxSetup)||m.isEmpty(this.ajaxSetup.url);if(i&&e&&n)throw new Error(d.tplSourceNotDefined);n?this.render():(this.showLoadingMask(),t=m.proxy(function(t){var e="text"==this.ajaxSetup.dataType?{template:t.data}:t.data;this.viewModel=m.isEmpty(e.viewModel)?this.viewModel:e.viewModel,this.template=m.isEmpty(e.template)?m.dom.getEl(this.templateSelector).outerHTML:e.template,this.publish("load-complete",null,this),this.render()},this),m.http.get({url:this.ajaxSetup.url,dataType:this.ajaxSetup.dataType,data:this.ajaxSetup.data,success:t}),t=null)},render:function(){var r,t,e,i,n,s,o,a,l,c,u,h,p=m.isEmpty(this.templateSelector);if(this.html=p?m.dom.clone(m.dom.parseTemplate(this.template)):m.dom.getEl(this.templateSelector),(r=this).addAttr({name:"data-componentId",value:this.id}),this.addCss(this.css),this.addAttr(this.attrs),this.addStyle(this.style),p){if(t=!m.isEmpty(this.renderTo),o=!m.isEmpty(this.renderAfter),s=!m.isEmpty(this.renderBefore),!t&&!o&&!s)throw new Error(d.tplContainerNotDefined);if(c=(u=!m.isEmpty(this.parentComponent))?m.str.format("{0} {1}",this.renderTo,(s?this.renderBefore:this.renderAfter)||"").trim():t?this.renderTo:s?this.renderBefore:this.renderAfter,e=m.dom.getEl(c),m.isEmpty(e))throw h=u?m.str.format(d.tplContainerNotFoundWithinComponent,c.split("]").pop().trim()):d.tplContainerNotFound,new Error(h);l=function(t,e){var i=r.traceUp(),n=m.isEmpty(i)?document:i.html;a=m.dom.getEl(t,{rootEl:n,all:!1}),m.dom[e](a,r.html),r.html=m.dom.getEl('*[data-componentid="'+r.id+'"]',{rootEl:n,all:!1})},s?l(c,"insertBefore"):o?l(c,"insertAfter"):m.isEmpty(this.insertAt)?m.dom[this.replace?"replaceWith":"append"](e,this.html):(i=this.traceUp().childAt(this.insertAt),n=m.isEmpty(i)?0:m.dom.indexOf(i.html),m.dom.insertAt(e,this.html,n)),this.publish("render-complete",null,this),this.init()}else this.init()},init:function(){var t,r=this;this.bindViewModel(),m.isEmpty(this.handlers)||m.forEach(this.handlers,function(t){r.handle(t)}),this.hideLoadingMask(),this.initialized=!0,this.publish("init-complete",null,this),m.isEmpty(this.components)||(t=this.components.reduce(function(t,e,i){var n=m.isEmpty(e.id)?null:r.traceDown(e.id);return(m.isEmpty(n)||!n.initialized)&&t.push({index:i,component:e}),t},[]),m.forEach(t,function(t){t.component.$replace=!0,r.addChild(t.component,t.index)}),m.arr.clear(t),t=null),m.isEmpty(this.parentComponent)||m.isEmpty(this.parentComponent.ref)||(this.parentComponent.$ref=null,delete this.parentComponent.$ref)},subscribe:function(t){!m.isEmpty(t)&&m.isObject(t)&&(this.triggers=m.obj.assignTo(this.triggers,t))},publish:function(n,e,t){var i=function(t,e){var i=m.isEmpty(t.triggers)?null:t.triggers[n];m.isEmpty(i)||i.call(t,e)};if(m.isEmpty(t))m.application.instances.filter(function(t){return m.isComponent(t)}).forEach(function(t){i(t,e)});else{var r=m.isString(t)?m.getInstanceOf(t):t;i(r,e)}},addChild:function(t,e){var i,n,r,s,o=t.$replace;if(m.isEmpty(t)||m.isEmpty(t.type))throw new Error(d.addChildParamErr);return delete t.$replace,i='*[data-componentid="'+this.id+'"]',t.autoLoad=!1,n=m.create(t),s=t.renderTo||n.renderTo,n.renderTo=m.isEmpty(s)?i.concat(m.isEmpty(this.containerElement)?"":" "+this.containerElement):"root"==s?i:i.concat(" ").concat(s),n.parentComponent={type:this.type,id:this.id},m.isEmpty(n.renderAfter)&&m.isEmpty(n.renderBefore)||(n.parentComponent.$ref=this),m.isEmpty(e)||o||(n.insertAt=e),n.autoLoad||n.load(),!m.isEmpty(this.components)||(this.components=[]),r={type:n.type,id:n.id},m.isEmpty(n.alias)||(r.alias=n.alias),m.isEmpty(e)?this.components.push(r):this.components.splice(e,o?1:0,r),r=null,n},handle:function(t){var e=m.isFunction(t.fn)?t.fn:this[t.fn];if(m.isEmpty(e))throw new Error(d.handlerFnNotProvided);var i=[t.on,this.html,t.selector,m.proxy(e,t.scope||this)];m.dom.on.apply(m.dom,i)},showLoadingMask:function(){var t=!m.isEmpty(this.renderTo);if(this.showLoading){var e=this.html;m.isEmpty(e)&&(e=t?m.dom.getEl(this.renderTo):m.dom.getEl(this.templateSelector)),m.isEmpty(e)||m.dom.append(e,d.loadingMaskMarkup),e=null}},hideLoadingMask:function(){var t,e=!m.isEmpty(this.renderTo);if(this.showLoading){if(t=this.html,m.isEmpty(t)&&(t=e?m.dom.getEl(this.renderTo):m.dom.getEl(this.templateSelector)),!m.isEmpty(t)){var i=m.dom.findElement(t,"div.loading-mask");m.isEmpty(i)||(m.dom.remove(i),i=null)}t=null}},lastChild:function(){return m.isEmpty(this.components)?null:this.childAt(this.components.length-1)},firstChild:function(){return this.childAt(0)},childAt:function(t){if(m.isEmpty(this.components)||m.isEmpty(t))return null;var e=this.components[t];return m.isEmpty(e)?null:m.getInstanceOf(e.id)||null},removeChild:function(t,e){var i,n;m.isEmpty(t)||(i=!!m.isEmpty(e)||e,n=this.childIndex(t),i&&t.destroy(),-1!=n&&this.components.splice(n,1),t=null)},childCount:function(){return m.isEmpty(this.components)?0:this.components.length},childIndex:function(i){var n=-1;return m.isEmpty(i)||m.arr.find(function(t,e){return t.id==i.id&&(n=e),t.id==i.id},this.components),n},destroy:function(){var t;if(!m.isEmpty(this.templateSelector))throw new Error(d.canNotDestroyComponent);this.publish("before-destroy",null,this),this.destroyChildren(),m.dom.off(this.html),m.isEmpty(this.viewModel)||this.unapplyBindings(),m.dom.remove(this.html),this.html=null,this.triggers=null,this.viewModel=null,m.arr.clear(this.components),m.arr.clear(this.handlers),m.arr.clear(this.mixins),t=this.traceUp(),m.isEmpty(t)||t.removeChild(this,!1),this.destroyed=!0,this.base(arguments),this.publish("destroy-complete",null,this)},destroyChildren:function(){for(var t;!m.isEmpty(this.components)&&null!=(t=this.components[0])&&!m.isEmpty(t.id);)m.getInstanceOf(t.id).destroy(),null},addCss:function(t,e){var i,n,r,s;m.isEmpty(t)||(r=m.isEmpty(e)?this.html:m.isString(e)?m.dom.findElement(this.html,e):e,m.isEmpty(r)||(i=m.isArray(t),n=!m.isEmpty(r.className),s=i?t.join(" "):t,r.className+=n?" "+s:s))},addStyle:function(t,e){var i,n,r,s;m.isEmpty(t)||(r=m.isEmpty(e)?this.html:m.isString(e)?m.dom.findElement(this.html,e):e,m.isEmpty(r)||(i=m.isArray(t),n=!m.isEmpty(r.style.cssText),s=i?t.join(" "):t,r.style.cssText+=n?" "+s:s))},addAttr:function(t,e){var i,n;m.isEmpty(t)||(i=m.isEmpty(e)?this.html:m.isString(e)?m.dom.findElement(this.html,e):e,m.isEmpty(i)||(n=m.isArray(t)?t:[t],m.forEach(n,function(t){i.setAttribute(t.name,t.value)}),n=null))},clearHtml:function(){m.forEach(this.html.childNodes,function(t){m.dom.remove(t)},this)}}}),m.define("mixin",function(){return{}}),m});